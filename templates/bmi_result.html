<!DOCTYPE html>
<html>
<head>
    <title>Your Results</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: #f8f9fa;
            padding: 2rem;
            font-family: 'Segoe UI', sans-serif;
        }

        .result-card {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(0,0,0,0.05);
            max-width: 700px;
            margin: auto;
        }

        .bmi-bar-container, .bf-bar-container {
            position: relative;
            display: flex;
            width: 100%;
            height: 30px;
            border-radius: 6px;
            overflow: visible;
            margin-top: 18px;
            margin-bottom: 30px;
            font-size: 12px;
            text-align: center;
            color: white;
            font-weight: bold;
        }

        .bmi-zone, .bf-zone {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .underweight { background-color: #a6bddb; }
        .normal { background-color: #74c476; }
        .overweight { background-color: #fdae6b; }
        .obese { background-color: #ef3b2c; }

        .essential { background-color: #c7e9c0; }
        .athletes  { background-color: #74c476; }
        .average   { background-color: #feb24c; }
        .above     { background-color: #fc9272; }

        .bmi-indicator, .bf-indicator {
            position: absolute;
            top: -15px;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 12px solid #000000;
            z-index: 10;
        }

        .metric-label {
            font-family: 'Georgia', serif;
            font-weight: 600;
            font-size: 2rem;
            color: #000000;
            text-align: center;
        }

        .result-header {
            font-family: 'Georgia', serif;
            font-weight: 700;
            font-size: 2.75rem;
            text-align: center;
        }
    </style>
</head>
<body>
<div class="result-card">
    <div class="mb-4">
        <h1 class="result-header">Your Results</h1>
        <div class="metric-label">BMI: {{ bmi }}</div>
        <div class="metric-label">Body Fat: {{ bodyfat_known }}</div>
    </div>

    <hr>
    <h5 class="mt-4">Details</h5>
    <ul class="list-group list-group-flush">
        <li class="list-group-item d-flex justify-content-between align-items-center">
            <span class="fw-semibold text-muted">Gender:</span>
            <span class="text-dark">{{ gender|capitalize }}</span>
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center">
            <span class="fw-semibold text-muted">Est. Pants Width:</span>
            <span class="text-dark">{{ waist }} inches</span>
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center">
            <span class="fw-semibold text-muted">Age:</span>
            <span class="text-dark">{{ age }}</span>
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center">
            <span class="fw-semibold text-muted">Region:</span>
            <span class="text-dark">{{ region }}</span>
        </li>
    </ul>

    <!-- BMI Bar -->
    <h5 class="text-center mb-2 mt-4">BMI Range</h5>
    <div class="bmi-bar-container">
        <div class="bmi-zone underweight">Underweight</div>
        <div class="bmi-zone normal">Normal</div>
        <div class="bmi-zone overweight">Overweight</div>
        <div class="bmi-zone obese">Obese</div>
        {% set bmi_val = bmi | float %}
        <div class="bmi-indicator" style="
            {% set bmi_val = [bmi | float, 50] | min %}
            {% if bmi_val < 18.5 %}
                left: {{ (bmi_val / 18.5) * 25 }}%;
            {% elif bmi_val < 25 %}
                left: {{ 25 + ((bmi_val - 18.5) / (25 - 18.5) * 25) }}%;
            {% elif bmi_val < 32 %}
                left: {{ 50 + ((bmi_val - 25) / (32 - 25) * 25) }}%;
            {% else %}
                left: {{ 75 + ((bmi_val - 32) / (50 - 32) * 25) }}%;
            {% endif %}
        "></div>
    </div>
    <p class="text-center" style="margin-top: -25px;"><strong>BMI:</strong> {{ bmi }}</p>

    <!-- Body Fat Bar -->
    <h5 class="text-center" style="margin-bottom: 1.25rem; margin-top: 2rem;">Body Fat % Range</h5>

    <div class="bf-bar-container">
        <div class="bf-zone essential">Essential</div>
        <div class="bf-zone athletes">Athletes</div>
        <div class="bf-zone average">Average</div>
        <div class="bf-zone above">Above Avg</div>
        <div class="bf-indicator" style="
            {% if gender == 'male' %}
                left: {{ (bodyfat_known|replace('%','')|float) * 2.5 }}%;
            {% else %}
                left: {{ (bodyfat_known|replace('%','')|float) * 2.2 }}%;
            {% endif %}
        "></div>
    </div>
    <p class="text-center" style="margin-top: -20px;"><strong>Body Fat:</strong> {{ bodyfat_known }}</p>

    <!-- Personalized Advice Section at the Bottom -->
    <div class="mt-5 pt-4 border-top">
        <h5 class="text-primary text-center mb-2">Personalized Advice</h5>
        <p class="text-dark text-center mb-0">{{ advice }}</p>
    </div>

    <div class="text-center mt-4">
        <a href="/" class="btn btn-primary">Back to Form</a>
    </div>
</div>
</body>
</html>
